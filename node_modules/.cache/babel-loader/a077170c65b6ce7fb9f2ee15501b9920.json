{"ast":null,"code":"var _jsxFileName = \"D:\\\\KA\\\\HOC HANH\\\\H\\u1ECCC L\\u1EACP TR\\xCCNH 2021\\\\FRONTEND64_20.03-27.09.2021\\\\Buoi33_17.07.2021_React-function\\\\Tro-choi-bai\\\\src\\\\components\\\\Control\\\\index.jsx\";\nimport React, { useCallback } from \"react\";\nimport axios from \"axios\";\nimport { useDispatch, useSelector } from \"react-redux\"; //dùng useStore khi cần lấy dữ liệu trên store xuống dùng mà component ko cần phải render lại, còn nếu component phải render lại thì dùng useSelector (do useSeclector đổi thì state của component cũng đổi nên phải render lại)\n\nconst Control = () => {\n  const deckCard = useSelector(state => {\n    return state.card.deckCard;\n  });\n  const playList = useSelector(state => {\n    return state.player.playerList;\n  });\n  const resultArr = [];\n  const dispatch = useDispatch();\n  const drawCards = useCallback(() => {\n    axios({\n      method: \"GET\",\n      url: `http://deckofcardsapi.com/api/deck/${deckCard.deck_id}/draw/?count=12`\n    }).then(res => {\n      const players = [...playList]; //chia bài\n\n      for (const i in res.data.cards) {\n        const playerIndex = i % 4;\n        players[playerIndex].cards.push(res.data.cards[i]); //i = 0, playerIndex = 0 => card[0] => player[0]\n        //i = 1, playerIndex = 1 => card[1] => player[1]\n        //i = 2, playerIndex = 2 => card[2] => player[2]\n        //i = 3, playerIndex = 3 => card[3] => player[3]\n        //i = 4, playerIndex = 0 => card[4] => player[0]\n        //i = 5, playerIndex = 1 => card[5] => player[1]\n        //i = 6, playerIndex = 2 => card[6] => player[2]\n      }\n\n      dispatch({\n        type: \"SET_PLAYERS\",\n        payload: players\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  }, [deckCard, playList]); //Hàm useStore dùng để lấy dữ liệu về dùng mà ko thay đổi state của component như useSelector\n  // const store = useStore();\n  // store.getState()\n\n  const revealCards = useCallback(() => {\n    //1. Lật bài\n    dispatch({\n      type: \"REVEAL_CARDS\"\n    }); //2. tính kết quả\n    //check playerList\n    //TH còn lại: cộng điểm người chơi, tìm max\n    //note: có thể có nhiều hơn 1 người thắng, danh sách người thắng phải là 1 cái mảng\n\n    const players = [...playList];\n    let winnerList = [];\n    const resultList = players.map(item => {\n      //TH đặc biệt : King, Jack, Queen\n      let arrKJQCase = item.cards.filter(card => card.value === \"QUEEN\" || card.value === \"KING\" || card.value === \"JACK\");\n\n      if (arrKJQCase.length === 3) {\n        winnerList.push(item);\n      } else {\n        const point = item.cards.reduce((pointCard, card, index) => {\n          if (card.value === \"ACE\") card.value = 1;\n          if (card.value === \"QUEEN\" || card.value === \"KING\" || card.value === \"JACK\") card.value = 10;\n          pointCard += +card.value;\n          return pointCard;\n        }, 0);\n        let playerList = {\n          username: item.username,\n          result: point % 10,\n          totalPoint: item.totalPoint\n        };\n        return playerList;\n      }\n    });\n    console.log(resultList);\n    resultList.forEach(item => {\n      for (let index in winnerList) {\n        if (item.result > winnerList[index].result) {\n          winnerList.splice(winnerList[index], 1);\n          winnerList.push(item);\n        }\n\n        if (item.result = winnerList[index].result) {\n          winnerList.push(item);\n        }\n      }\n    });\n    console.log(winnerList);\n  }, [dispatch]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex  justify-content-end container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"border d-flex justify-content-center align-items-center px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-success mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  }, \"Shuffle\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-info mr-2\",\n    onClick: drawCards,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, \"Draw\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-primary mr-2\",\n    onClick: revealCards,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  }, \"Reveal\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }, playList.map(item => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.username,\n      className: \"border px-3 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 15\n      }\n    }, item.username), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 15\n      }\n    }, \" \", item.totalPoint, \" \"));\n  })));\n};\n\nexport default Control;","map":{"version":3,"sources":["D:/KA/HOC HANH/HỌC LẬP TRÌNH 2021/FRONTEND64_20.03-27.09.2021/Buoi33_17.07.2021_React-function/Tro-choi-bai/src/components/Control/index.jsx"],"names":["React","useCallback","axios","useDispatch","useSelector","Control","deckCard","state","card","playList","player","playerList","resultArr","dispatch","drawCards","method","url","deck_id","then","res","players","i","data","cards","playerIndex","push","type","payload","catch","err","console","log","revealCards","winnerList","resultList","map","item","arrKJQCase","filter","value","length","point","reduce","pointCard","index","username","result","totalPoint","forEach","splice"],"mappings":"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","sourcesContent":["import React, { useCallback } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useDispatch, useSelector } from \"react-redux\"; //dùng useStore khi cần lấy dữ liệu trên store xuống dùng mà component ko cần phải render lại, còn nếu component phải render lại thì dùng useSelector (do useSeclector đổi thì state của component cũng đổi nên phải render lại)\r\n\r\nconst Control = () => {\r\n  const deckCard = useSelector((state) => {\r\n    return state.card.deckCard;\r\n  });\r\n  const playList = useSelector((state) => {\r\n    return state.player.playerList;\r\n  });\r\n\r\n  const resultArr = [];\r\n  const dispatch = useDispatch();\r\n\r\n  const drawCards = useCallback(() => {\r\n    axios({\r\n      method: \"GET\",\r\n      url: `http://deckofcardsapi.com/api/deck/${deckCard.deck_id}/draw/?count=12`\r\n    })\r\n      .then((res) => {\r\n        const players = [...playList];\r\n        //chia bài\r\n        for (const i in res.data.cards) {\r\n          const playerIndex = i % 4;\r\n          players[playerIndex].cards.push(res.data.cards[i]);\r\n\r\n          //i = 0, playerIndex = 0 => card[0] => player[0]\r\n          //i = 1, playerIndex = 1 => card[1] => player[1]\r\n          //i = 2, playerIndex = 2 => card[2] => player[2]\r\n          //i = 3, playerIndex = 3 => card[3] => player[3]\r\n          //i = 4, playerIndex = 0 => card[4] => player[0]\r\n          //i = 5, playerIndex = 1 => card[5] => player[1]\r\n          //i = 6, playerIndex = 2 => card[6] => player[2]\r\n        }\r\n        dispatch({ type: \"SET_PLAYERS\", payload: players });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }, [deckCard, playList]);\r\n\r\n  //Hàm useStore dùng để lấy dữ liệu về dùng mà ko thay đổi state của component như useSelector\r\n  // const store = useStore();\r\n  // store.getState()\r\n\r\n  const revealCards = useCallback(() => {\r\n    //1. Lật bài\r\n    dispatch({ type: \"REVEAL_CARDS\" });\r\n    //2. tính kết quả\r\n    //check playerList\r\n\r\n    //TH còn lại: cộng điểm người chơi, tìm max\r\n    //note: có thể có nhiều hơn 1 người thắng, danh sách người thắng phải là 1 cái mảng\r\n    const players = [...playList];\r\n    let winnerList = [];\r\n\r\n    const resultList = players.map((item) => {\r\n      //TH đặc biệt : King, Jack, Queen\r\n      let arrKJQCase = item.cards.filter(\r\n        (card) =>\r\n          card.value === \"QUEEN\" ||\r\n          card.value === \"KING\" ||\r\n          card.value === \"JACK\"\r\n      );\r\n      if (arrKJQCase.length === 3) {\r\n        winnerList.push(item);\r\n      } else {\r\n        const point = item.cards.reduce((pointCard, card, index) => {\r\n          if (card.value === \"ACE\") card.value = 1;\r\n          if (\r\n            card.value === \"QUEEN\" ||\r\n            card.value === \"KING\" ||\r\n            card.value === \"JACK\"\r\n          )\r\n            card.value = 10;\r\n          pointCard += +card.value;\r\n          return pointCard;\r\n        }, 0);\r\n        let playerList = {\r\n          username: item.username,\r\n          result: point % 10,\r\n          totalPoint: item.totalPoint\r\n        };\r\n        return playerList;\r\n      }\r\n    });\r\n\r\n    console.log(resultList);\r\n    resultList.forEach((item) => {\r\n      for (let index in winnerList) {\r\n        if (item.result > winnerList[index].result) {\r\n          winnerList.splice(winnerList[index], 1);\r\n          winnerList.push(item);\r\n        }\r\n        if ((item.result = winnerList[index].result)) {\r\n          winnerList.push(item);\r\n        }\r\n      }\r\n    });\r\n    console.log(winnerList);\r\n  }, [dispatch]);\r\n\r\n  return (\r\n    <div className=\"d-flex  justify-content-end container\">\r\n      <div className=\"border d-flex justify-content-center align-items-center px-2\">\r\n        <button className=\"btn btn-success mr-2\">Shuffle</button>\r\n        <button className=\"btn btn-info mr-2\" onClick={drawCards}>\r\n          Draw\r\n        </button>\r\n        <button className=\"btn btn-primary mr-2\" onClick={revealCards}>\r\n          Reveal\r\n        </button>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        {playList.map((item) => {\r\n          return (\r\n            <div key={item.username} className=\"border px-3 text-center\">\r\n              <p>{item.username}</p>\r\n              <p> {item.totalPoint} </p>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Control;\r\n"]},"metadata":{},"sourceType":"module"}